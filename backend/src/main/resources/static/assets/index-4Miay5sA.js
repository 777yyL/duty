import{r as f}from"./request-DvWMyphm.js";import{d as L,r as m,v as Q,i as W,h as t,e as l,f as r,E as c,l as X,m as Y,b as ee,o as d,t as C,k as v,x as te,p as H,_ as le}from"./index-CM2DhkoH.js";const g={listEnabled(){return f({url:"/shift/list/enabled",method:"get"})},page(n){return f({url:"/shift/page",method:"get",params:n})},getById(n){return f({url:`/shift/${n}`,method:"get"})},save(n){return f({url:"/shift",method:"post",data:n})},update(n){return f({url:"/shift",method:"put",data:n})},delete(n){return f({url:`/shift/${n}`,method:"delete"})}},ae={class:"shift-container"},oe={class:"card-header"},re={class:"dialog-footer"},se=L({__name:"index",setup(n){const b=m([]),h=m(!1),p=m(!1),V=m(""),y=m(!1),w=m(),o=m({shiftName:"",shiftCode:"",startTime:"",endTime:"",sortOrder:0,status:1,remark:""}),U={shiftName:[{required:!0,message:"请输入班次名称",trigger:"blur"},{min:2,max:50,message:"班次名称长度在 2 到 50 个字符",trigger:"blur"}],shiftCode:[{required:!0,message:"请输入班次代码",trigger:"blur"},{pattern:/^[A-Z_]+$/,message:"班次代码只能包含大写字母和下划线",trigger:"blur"}],startTime:[{required:!0,message:"请选择开始时间",trigger:"change"}],endTime:[{required:!0,message:"请选择结束时间",trigger:"change"}]},k=async()=>{h.value=!0;try{const s=await g.listEnabled();b.value=s||[]}catch(s){console.error("加载数据失败:",s),c.error("加载数据失败")}finally{h.value=!1}},O=()=>{V.value="新增班次",o.value={shiftName:"",shiftCode:"",startTime:"",endTime:"",sortOrder:b.value.length,status:1,remark:""},p.value=!0},$=s=>{V.value="编辑班次",o.value={...s},p.value=!0},q=s=>{te.confirm(`确定要删除班次"${s.shiftName}"吗？删除后不可恢复！`,"删除确认",{type:"warning",confirmButtonText:"确定",cancelButtonText:"取消"}).then(async()=>{try{await g.delete(s.id),c.success("删除成功"),k()}catch(e){console.error("删除失败:",e)}}).catch(()=>{})},I=async()=>{w.value&&await w.value.validate(async s=>{if(s){y.value=!0;try{o.value.id?(await g.update(o.value),c.success("更新成功")):(await g.save(o.value),c.success("新增成功")),p.value=!1,k()}catch(e){console.error("提交失败:",e),c.error(e.message||"操作失败")}finally{y.value=!1}}})};return Q(()=>{k()}),(s,e)=>{const M=r("Plus"),x=r("el-icon"),_=r("el-button"),i=r("el-table-column"),N=r("el-tag"),A=r("Edit"),R=r("Delete"),z=r("el-table"),G=r("el-card"),T=r("el-input"),u=r("el-form-item"),E=r("el-time-picker"),D=r("el-col"),P=r("el-row"),S=r("el-input-number"),B=r("el-radio"),Z=r("el-radio-group"),j=r("el-form"),F=r("el-dialog"),J=Y("loading");return H(),W("div",ae,[t(G,null,{header:l(()=>[v("div",oe,[e[10]||(e[10]=v("span",{class:"title"},"班次配置管理",-1)),t(_,{type:"primary",onClick:O},{default:l(()=>[t(x,null,{default:l(()=>[t(M)]),_:1}),e[9]||(e[9]=d(" 新增班次 ",-1))]),_:1})])]),default:l(()=>[X((H(),ee(z,{data:b.value,border:"",stripe:""},{default:l(()=>[t(i,{type:"index",label:"序号",width:"60",align:"center"}),t(i,{prop:"shiftName",label:"班次名称","min-width":"120"}),t(i,{prop:"shiftCode",label:"班次代码","min-width":"120"}),t(i,{label:"时间段","min-width":"180"},{default:l(({row:a})=>[t(N,{type:"info"},{default:l(()=>[d(C(a.startTime)+" - "+C(a.endTime),1)]),_:2},1024)]),_:1}),t(i,{prop:"sortOrder",label:"排序",width:"80",align:"center"}),t(i,{label:"状态",width:"80",align:"center"},{default:l(({row:a})=>[t(N,{type:a.status===1?"success":"danger"},{default:l(()=>[d(C(a.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(i,{prop:"remark",label:"备注","min-width":"150","show-overflow-tooltip":""}),t(i,{label:"操作",width:"180",fixed:"right",align:"center"},{default:l(({row:a})=>[t(_,{link:"",type:"primary",size:"small",onClick:K=>$(a)},{default:l(()=>[t(x,null,{default:l(()=>[t(A)]),_:1}),e[11]||(e[11]=d(" 编辑 ",-1))]),_:1},8,["onClick"]),t(_,{link:"",type:"danger",size:"small",onClick:K=>q(a)},{default:l(()=>[t(x,null,{default:l(()=>[t(R)]),_:1}),e[12]||(e[12]=d(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[J,h.value]])]),_:1}),t(F,{modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=a=>p.value=a),title:V.value,width:"600px","close-on-click-modal":!1},{footer:l(()=>[v("span",re,[t(_,{onClick:e[7]||(e[7]=a=>p.value=!1)},{default:l(()=>[...e[17]||(e[17]=[d("取消",-1)])]),_:1}),t(_,{type:"primary",onClick:I,loading:y.value},{default:l(()=>[...e[18]||(e[18]=[d(" 确定 ",-1)])]),_:1},8,["loading"])])]),default:l(()=>[t(j,{model:o.value,rules:U,ref_key:"formRef",ref:w,"label-width":"100px"},{default:l(()=>[t(u,{label:"班次名称",prop:"shiftName"},{default:l(()=>[t(T,{modelValue:o.value.shiftName,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.shiftName=a),placeholder:"请输入班次名称，如：早班、晚班",clearable:""},null,8,["modelValue"])]),_:1}),t(u,{label:"班次代码",prop:"shiftCode"},{default:l(()=>[t(T,{modelValue:o.value.shiftCode,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.shiftCode=a),placeholder:"请输入班次代码，如：MORNING、EVENING",clearable:"",disabled:!!o.value.id},null,8,["modelValue","disabled"]),e[13]||(e[13]=v("div",{class:"form-tip"},"班次代码创建后不可修改，建议使用大写英文",-1))]),_:1}),t(P,{gutter:20},{default:l(()=>[t(D,{span:12},{default:l(()=>[t(u,{label:"开始时间",prop:"startTime"},{default:l(()=>[t(E,{modelValue:o.value.startTime,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.startTime=a),format:"HH:mm","value-format":"HH:mm",placeholder:"请选择开始时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(D,{span:12},{default:l(()=>[t(u,{label:"结束时间",prop:"endTime"},{default:l(()=>[t(E,{modelValue:o.value.endTime,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.endTime=a),format:"HH:mm","value-format":"HH:mm",placeholder:"请选择结束时间",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(u,{label:"排序",prop:"sortOrder"},{default:l(()=>[t(S,{modelValue:o.value.sortOrder,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.sortOrder=a),min:0,max:999,step:1,style:{width:"100%"}},null,8,["modelValue"]),e[14]||(e[14]=v("div",{class:"form-tip"},"数字越小排序越靠前",-1))]),_:1}),t(u,{label:"状态",prop:"status"},{default:l(()=>[t(Z,{modelValue:o.value.status,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.status=a)},{default:l(()=>[t(B,{label:1},{default:l(()=>[...e[15]||(e[15]=[d("启用",-1)])]),_:1}),t(B,{label:0},{default:l(()=>[...e[16]||(e[16]=[d("禁用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(u,{label:"备注",prop:"remark"},{default:l(()=>[t(T,{modelValue:o.value.remark,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.remark=a),type:"textarea",rows:3,placeholder:"请输入备注信息（选填）",maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ie=le(se,[["__scopeId","data-v-b93c0f40"]]);export{ie as default};
